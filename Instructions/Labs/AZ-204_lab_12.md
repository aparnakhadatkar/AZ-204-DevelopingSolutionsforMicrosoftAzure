# Lab 12: Enhance a web application by using the Azure Content Delivery Network

## Lab Scenario

In this lab, you will implement the Azure Content Delivery Network capabilities to provide a caching solution based on customer locations. The lab configures a storage account for image and video files, which are impacted the most by the latency issues. You will use the Azure Content Delivery Network to implement the caching solution to aid in reducing latency for these image and video files.

## Lab objectives

In this lab, you will perform:

+ Exercise 1: Create Azure resources
+ Exercise 2: Configure Content Delivery Network and Endpoints
+ Exercise 3: Upload and configure static web content
+ Exercise 4: Use Content Delivery Network endpoints
  
## Estimated timing: 60 minutes

## Architecture diagram

![Architecture diagram depicting a user enhancing a web application by using the Azure Content Delivery Network](./media/Lab12-Diagram1.png)

## Exercise 1: Create Azure resources

In this exercise, you create an Azure Storage account and an Azure Web App that you'll use later in this lab.

### Task 1: Open the Azure portal

1. If you are not logged in already, click on the **Azure portal** shortcut that is available on the desktop and log in with Azure credentials.

1. If not Sign-in, then on the **Sign into Microsoft Azure** tab you will see the login screen, in that enter the following **Email/**Username** and then click on **Next**. 

   * Email/Username: <inject key="AzureAdUserEmail"></inject>
   
     ![](https://github.com/CloudLabsAI-Azure/AIW-SAP-on-Azure/raw/main/media/M2-Ex1-portalsignin-1.png?raw=true)
    
1. Now enter the following **Password** and click on **Sign in**.

   * Password: <inject key="AzureAdUserPassword"></inject>

     ![](./media/M2-Ex1-portalsignin-(2).png)
    
1. If you see the pop-up **Stay Signed in?**, click No.

    ![](./media/staysignedinNO1.png)

1. On the **Welcome to Microsoft Azure** page, click on **Cancel**.

    ![](./media/15125(1).png)

### Task 2: Create a Storage account

1. In the Azure portal, use the **Search resources, services, and docs** text box to search for **Storage account**, and then in the list of results, select **Storage accounts**.

1. On the **Storage accounts** blade, select **+ Create**.

1. On the **Create a storage account** blade, on the **Basics** tab, perform the following actions, and then select **Next: Advanced >**:

   | Setting                           | Action                                                       |
   | --------------------------------- | ------------------------------------------------------------ |
   | **Subscription** drop-down list   | Retain the default value.                                    |
   | **Resource group** section        | Select **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** 
   | **Storage account name** text box | Enter **contenthost<inject key="DeploymentID" enableCopy="false"/>**                            |
   | **Region** drop-down list         | Select **(US) West US**.                                     |
   | **Primary service**               | No changes |
   | **Performance** section           | Select the **Standard** option.                               |
   | **Redundancy** drop-down list     | Select **Locally-redundant storage (LRS)**.                  |

    The following screenshot displays the configured settings in the **Create a storage account** blade.

    ![Screenshot displaying the configured settings on the Create a storage account blade](./media/15125(14).png)

1. On the **Advanced** tab, ensure **Allow enabling anonymous access on individual containers** is enabled. Check the box if it is not enabled.

1. Click on the **Review + create** tab, and review the options that you selected during the previous steps.

1. Select **Create** to create the storage account by using your specified configuration.

    > **Note**: Wait for the creation task to complete before you move forward with this lab.

### Task 3: Create a web app by using Azure App Service

1. On the Azure portal's navigation pane, select **+ Create a resource**.

1. On the **Create a resource** blade, in the **Search services and marketplace** text box, enter **Web App**, and then select Enter.

1. On the search results blade, select the **Web App** result, and then select **Create**.

1. On the **Create Web App** blade, on the **Basics** tab, perform the following actions, and then select **Next: Container**:

   | Setting                           | Action                                                       |
   | --------------------------------- | ------------------------------------------------------------ |
   | **Subscription** drop-down list   | Retain the default value.                                    |
   | **Resource group** drop-down list | Select **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** in the list                    |
   | **Name** text box                 | Enter **landingpage<inject key="DeploymentID" enableCopy="false"/>**                           |
   | **Secure unique default hostname** | **Disabled** |
   | **Publish** section               | Select **Container**                                 |
   | **Operating System** section      | Select **Linux**                                            |
   | **Region** drop-down list         | Select **West US**                                         |
   | **Linux Plan (East US)** section  | Select **Create new**. In the **Name** text box, enter **MarketingPlan**, and then select **OK**. |
   | **Pricing plan** section          | Select **Premium V3 P1V3**                               |

   The following screenshot displays the configured settings on the **Create Web App** blade.

   ![Screenshot displaying the configured settings on the Create a storage account blade](./media/15125(15).png)

1. On the **Container** tab, perform the following actions, and then select **Review + create**:

    | Setting | Action |
    | -- | -- |
    | **Sidecar support (preview)** | Select **Disabled** |
    | **Image Source**  | Select **Other Container registries** |
    | **Access Type** drop-down list | Select **Public** |
    | **Registry server URL** | Enter `https://index.docker.io` |
    | **Image and tag** text box | Enter **microsoftlearning/edx-html-landing-page:latest** |

   The following screenshot displays the configured settings on the **Container** tab.

   ![Screenshot displaying the configured settings on the Create a storage account blade](./media/15125(16).png)

1. On the **Review + create** tab, review the options that you selected during the previous steps.

1. Select **Create** to create the web app by using your specified configuration.

    > **Note**: Wait for the creation task to complete before you move forward with this lab.

1. On the **Deployment** blade, select **Go to resource**.

1. On the **App Service Overview** blade, in the **Essentials**, record the value of the **Default domain** link. You'll use this value later in the lab.

   > **Congratulations** on completing the task! Now, it's time to validate it. Here are the steps:

   - Hit the Validate button for the corresponding task. If you receive a success message, you can proceed to the next task. 
   - If not, carefully read the error message and retry the step, following the instructions in the lab guide.
   - If you need any assistance, please contact us at labs-support@spektrasystems.com. We are available 24/7 to help you out.
 
### Review

In this exercise, you created an Azure Storage account and an Azure Web App that you'll use later in this lab.

## Exercise 2: Configure Content Delivery Network and Endpoints

In this exercise, you registered the resource provider for Content Delivery Network (CDN), and then used the provider to create both a CDN profile and endpoint resources.

### Task 1: Open Azure Cloud Shell

1. In the Azure portal, select the **Cloud Shell** icon ![Cloud Shell icon](./media/az204_lab_CloudShell.png) to open a Cloud Shell. Select **Bash** in the **Cloud Shell** menu.

    > **Note**: The **Cloud Shell** icon is represented by a greater than sign (\>) and underscore character (\_).

    > **Note**: If this is the first time you're starting **Cloud Shell** you will be presented with a **Getting started** prompt. Select **No storage account required**, then select **Apply**.

1. In the Azure portal, at the **Cloud Shell** command prompt, run the following command to get the version of the Azure Command-Line Interface (Azure CLI) tool:

    ```bash
    az --version
    ```

### Task 2: Register the Microsoft.CDN provider

1. At the **Cloud Shell** command prompt in the portal, perform the following actions:

    - Enter the following command to check if the Microsoft.CDN has been registered. Proceed to step 2. if the Microsoft.CDN has already been registered:

        ```bash
        az provider show --namespace Microsoft.CDN --query "registrationState"
        ```

1. Close the **Cloud Shell** pane in the portal.

### Task 3: Create a Content Delivery Network profile

1. On the Azure portal's navigation pane, select **+ Create a resource**.

1. On the **Create a resource** blade, in the **Search services and marketplace** text box, enter **CDN**, and then select Enter.

1. On the **Marketplace** search results blade, select the **Front Door and CDN profiles** result, and then select **Create**.

1. On the **Compare offerings** page, select **Explore other offerings** and then select **Azure CDN Standard from Microsoft (classic)**, and then select **Continue**.

1. On the **CDN profile** blade, on the **Basics** tab, perform the following actions, and then select **Review + create**:

   | Setting                                     | Action                                   |
   | ------------------------------------------- | ---------------------------------------- |
   | **Subscription** drop-down list             | Retain the default value.                |
   | **Resource group** drop-down list           | Select **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** in the list. |
   | **Name** text box                           | Enter **contentdeliverynetwork**.        |
   | **Region** text box                         | Retain the default value (Global).       |
   | **Pricing tier** drop-down list             | Select **Microsoft CDN (classic)**       |
   | **Create a new CDN endpoint** check box     | Not selected.                            |

   The following screenshot displays the configured settings on the **CDN profile** blade.

    ![](./media/lab12-8.png)

1. On the **Review + create** tab, review the options that you selected during the previous steps.

1. Select **Create** to create the CDN profile by using your specified configuration.
  
    > **Note**: Wait for Azure to finish creating the CDN profile before you move forward with the lab. You'll receive a notification when the profile is created.

### Task 4: Configure Storage containers

1. On the Azure portal's navigation pane, select **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **contenthost<inject key="DeploymentID" enableCopy="false"/>** storage account that you created previously in this lab.

1. On the **Storage account** blade, select the **Containers** link in the **Data storage** section.

1. In the **Containers** section, select **+ Container**.

1. In the **New container** pop-up window, perform the following actions, and then select **Create**:

   | Setting                                | Action                                                  |
   | -------------------------------------- | ------------------------------------------------------- |
   | **Name** text box                      | Enter **media**                                        |
   | **Public access level** drop-down list | Select **Blob (anonymous read access for blobs only)**. |

1. In the **Containers** section, select **+ Container** again.

1. In the **New container** pop-up window, perform the following actions, and then select **Create**:

   | Setting                                | Action                                                  |
   | -------------------------------------- | ------------------------------------------------------- |
   | **Name** text box                      | Enter **video**                                        |
   | **Public access level** drop-down list | Select **Blob (anonymous read access for blobs only)**. |

1. Observe the updated list of containers and confirm that both the **media** and **video** containers are listed.

### Task 5: Create Content Delivery Network endpoints

1. On the Azure portal's navigation pane, select the **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **contentdeliverynetwork** CDN profile that you created previously in this lab.

1. On the **CDN profile** blade, select **+ Endpoint**.

1. In the **Add an endpoint** pop-up dialog box, perform the following actions, and then select **Add (7)**:

   | Setting                                   | Action                                                       |
   | ----------------------------------------- | ------------------------------------------------------------ |
   | **Name** text box                         | Enter **cdnmedia<inject key="DeploymentID" enableCopy="false"/> (1)**                              |
   | **Origin type** drop-down list            | Select **Storage (2)**.                                          |
   | **Origin hostname** drop-down list        | Select the **contenthost<inject key="DeploymentID"  enableCopy="false"/>.blob.core.windows.net (3)** option for the Storage account that you created previously in this lab. |
   | **Origin path** text box                  | Enter **/media (4)**                                            |
   | **Origin host header** text box           | Retain the default value **(5)**.                                    |
   | **Protocol** and **Origin port** sections | Retain the default values.                                   |
   | **Optimized for** drop-down list          | Select **General web delivery (6)**.                             |

   The following screenshot displays the configured settings in the **Add an endpoint** dialog box.

   ![Screenshot displaying the configured settings in the Add an endpoint dialog box.](./media/lab12-4.png)

1. On the **CDN profile** blade, select **+ Endpoint** again.

1. In the **Add an endpoint** pop-up dialog box, perform the following actions, and then select **Add (7)**:

   | Setting                                   | Action                                                       |
   | ----------------------------------------- | ------------------------------------------------------------ |
   | **Name** text box                         | Enter **cdnvideo<inject key="DeploymentID" enableCopy="false"/> (1)**                              |
   | **Origin type** drop-down list            | Select **Storage (2)**.                                          |
   | **Origin hostname** drop-down list        | Select the **contenthost<inject key="DeploymentID" enableCopy="false"/>.blob.core.windows.net (3)** option for the Storage account that you created previously in this lab. |
   | **Origin path** text box                  | Enter **/video (4)**                                            |
   | **Origin host header** text box           | Retain the default value.**(5)**                                    |
   | **Protocol** and **Origin port** sections | Retain the default values.                                   |
   | **Optimized for** drop-down list          | Select **General web delivery (6)**.                             |

   The following screenshot displays the configured settings in the **Add an endpoint** dialog box.

   ![Screenshot displaying the configured settings in the Add an endpoint dialog box.](./media/lab12-5.png)

1. On the **CDN profile** blade, select **+ Endpoint** again.

1. In the **Add an endpoint** pop-up dialog box, perform the following actions, and then select **Add (7)**:

   | Setting                                   | Action                                                       |
   | ----------------------------------------- | ------------------------------------------------------------ |
   | **Name** text box                         | Enter **cdnweb<inject key="DeploymentID" enableCopy="false"/> (1)**                                |
   | **Origin type** drop-down list            | Select **Web App (2)**.                                          |
   | **Origin hostname** drop-down list        | Select the **landingpage<inject key="DeploymentID" enableCopy="false"/>.azurewebsites.net (3)** option for the web app that you created previously in this lab. |
   | **Origin path** text box                  | Retain the default value. **(4)**                                   |
   | **Origin host header** text box           | Retain the default value. **(5)**                                   |
   | **Protocol** and **Origin port** sections | Retain the default values.                                   |
   | **Optimized for** drop-down list          | Select **General web delivery (6)**.                             |

   The following screenshot displays the configured settings in the **Add an endpoint** dialog box.

   ![Screenshot displaying the configured settings in the Add an endpoint dialog box.](./media/lab12-6.png)
   
    > **Congratulations** on completing the task! Now, it's time to validate it. Here are the steps:

    > - Hit the Validate button for the corresponding task. If you receive a success message, you can proceed to the next task. 
    > - If not, carefully read the error message and retry the step, following the instructions in the lab guide.
    > - If you need any assistance, please contact us at labs-support@spektrasystems.com. We are available 24/7 to help.

### Review

In this exercise, you registered the resource provider for Content Delivery Network (CDN) and then used the provider to create both a CDN profile and endpoint resources.

## Exercise 3: Upload and configure static web content

In this exercise, you upload multimedia content as blobs to Storage containers and then update your web app to point directly to the storage blobs.

### Task 1: Observe the landing page

1. On the Azure portal's navigation pane, select **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **landingpage<inject key="DeploymentID" enableCopy="false"/>** web app that you created previously in this lab.

1. On the **App Service** blade, select **Browse**. A new browser tab opens and returns the current website. Observe the error message displayed on the screen. The website won't work until you configure the specified settings to reference multimedia content.

1. Return to your currently open browser window that's displaying the Azure portal.

### Task 2: Upload Storage blobs

1. On the Azure portal's navigation pane, select **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **contenthost<inject key="DeploymentID" enableCopy="false"/>** storage account that you created previously in this lab.

1. On the **Storage account** blade, select the **Containers** link in the **Data storage** section.

1. In the **Containers** section, select the **media** container, and then select **Upload**.

1. In the **Upload blob** pop-up window, perform the following actions:

    a. In the **Files** section, click on **Browse for files** link.

    b. In the **File Explorer** window, browse to **Allfiles C:\AllFiles\AZ-204-DevelopingSolutionsforMicrosoftAzure-master\Allfiles\Labs\12\Starter**, select the following files, and then select **Open**:

    - **campus.jpg**

    - **conference.jpg**

    - **poster.jpg**

    c. Ensure that **Overwrite if files already exist** is selected, and then select **Upload**.  

    > **Note**: Wait for the blob to upload before you continue with this lab.

1. On the **Container** blade, select **Properties** in the **Settings** section.

1. Record the value in the **URL** text box. You'll use this value later in the lab.

1. Close the **Container** blade.

1. On the **Containers** blade, select the **video** container, and then select **Upload**.

1. In the **Upload blob** pop-up window, perform the following actions:

    a. In the **Files** section, click on **Browse for files** link.

    b. In the **File Explorer** window, browse to **Allfiles C:\AllFiles\AZ-204-DevelopingSolutionsforMicrosoftAzure-master\Allfiles\Labs\12\Starter**, select the **welcome.mp4** file, and then select **Open**.

    c. Ensure that **Overwrite if files already exist** is selected, and then select **Upload**.  

    > **Note**: Wait for the blob to upload before you continue with this lab.

1. On the **Container** blade, select **Properties** in the **Settings** section.

1. Record the value in the **URL** text box. You'll use this value later in the lab.

### Task 3: Configure Web App settings

1. On the Azure portal's navigation pane, select **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **landingpage<inject key="DeploymentID" enableCopy="false"/>** web app that you created previously in this lab.

1. On the **App Service** blade, in the **Settings** section, select the **Environment variables** link.

1. In the **App settings** tab, select **+ Add**. Enter the following information in the **Add/Edit application setting** pop-up dialog:

   | Setting                               | Action                                                       |
   | ------------------------------------- | ------------------------------------------------------------ |
   | **Name** text box                     | Enter **CDNMediaEndpoint**                                 |
   | **Value** text box                    | Enter the **URI** value of the **media** container in the **contenthost<inject key="DeploymentID" enableCopy="false"/>** storage account that you recorded previously in this lab. |
   | **Deployment slot setting** check box | Retain the default value                                               |

1. Select **Apply** to close the pop-up dialog and return to the **App settings** section.

   ![Screenshot displaying the configured settings on the Create a storage account blade](./media/15125(17).png)
   
1. In the **App settings** tab, select **+ Add**. Enter the following information in the **Add/Edit application setting** pop-up dialog:

   | Setting                               | Action                                                       |
   | ------------------------------------- | ------------------------------------------------------------ |
   | **Name** text box                     | Enter **CDNVideoEndpoint**                                  |
   | **Value** text box                    | Enter the **URI** value of the **video** container in the **contenthost<inject key="DeploymentID" enableCopy="false"/>** storage account that you recorded previously in this lab. |
   | **Deployment slot setting** check box | Retain the default value                                               |

1. Select **Apply** to close the pop-up dialog and return to the **App settings** section.

   ![Screenshot displaying the configured settings on the Create a storage account blade](./media/15125(18).png)

1. At the bottom of the **App settings** section, select **Apply**.

   >**Note:** You may receive a warning that your app may restart when updating app settings. Select **Confirm**. Wait for your application settings to save before you continue with the lab.

### Task 4: Validate the corrected landing page

1. On the Azure portal's navigation pane, select **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **landingpage<inject key="DeploymentID" enableCopy="false"/>** web app that you created previously in this lab.

1. On the **App Service** blade, select **Restart**, and then select **Yes** to confirm the app restart process.

   > **Note**: Wait for the restart operation to complete before you move forward with the lab. You'll receive a notification when the operation is done.

1. On the **App Service** blade, select **Browse**. A new browser window or tab will open and return to the current website. Observe the updated website rendering multimedia content of various types.

1. Return to your currently open browser window that's displaying the Azure portal.

    > **Congratulations** on completing the task! Now, it's time to validate it. Here are the steps:

    > - Hit the Validate button for the corresponding task. If you receive a success message, you can proceed to the next task. 
    > - If not, carefully read the error message and retry the step, following the instructions in the lab guide.
    > - If you need any assistance, please contact us at labs-support@spektrasystems.com. We are available 24/7 to help.

### Review

In this exercise, you uploaded multimedia content as blobs to Storage containers and then updated your web app to point directly to the storage blobs.

## Exercise 4: Use Content Delivery Network endpoints

In this exercise, you update your web app to use Content Delivery Network to serve multimedia content and to serve the web application itself.

### Task 1: Retrieve endpoint Uniform Resource Identifiers (URIs)

1. On the Azure portal's navigation pane, select the **Resource groups** link.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **contentdeliverynetwork** CDN profile that you created previously in this lab.

1. On the **CDN profile** blade, select the **cdnmedia<inject key="DeploymentID" enableCopy="false"/>** endpoint.

1. On the **Endpoint** blade, copy the value of the **Endpoint hostname** link. You'll use this value later in the lab.

1. Close the **Endpoint** blade.

1. On the **CDN profile** blade, select the **cdnvideo<inject key="DeploymentID" enableCopy="false"/>** endpoint.

1. On the **Endpoint** blade, copy the value of the **Endpoint hostname** link. You'll use this value later in the lab.

1. Close the **Endpoint** blade.

### Task 2: Test multimedia content

1. Construct a URL for the **campus.jpg** resource by combining the **Endpoint hostname** URL from the **cdnmedia<inject key="DeploymentID" enableCopy="false"/>** endpoint that you copied previously in the lab with a relative path of **/campus.jpg**.

    > **Note**: For example, if your **Endpoint hostname** URL is `https://cdnmediastudent.azureedge.net/`, your newly constructed URL would be `https://cdnmediastudent.azureedge.net/campus.jpg`.

2. Construct a URL for the **conference.jpg** resource by combining the **Endpoint hostname** URL from the **cdnmedia<inject key="DeploymentID" enableCopy="false"/>** endpoint that you copied previously in the lab with a relative path of **/conference.jpg**.

    > **Note**: For example, if your **Endpoint hostname** URL is `https://cdnmediastudent.azureedge.net/`, your newly constructed URL would be `https://cdnmediastudent.azureedge.net/conference.jpg`.

3. Construct a URL for the **poster.jpg** resource by combining the **Endpoint hostname** URL from the **cdnmedia<inject key="DeploymentID" enableCopy="false"/>** endpoint that you copied previously in the lab with a relative path of **/poster.jpg**.

    > **Note**: For example, if your **Endpoint hostname** URL is `https://cdnmediastudent.azureedge.net/`, your newly constructed URL would be `https://cdnmediastudent.azureedge.net/poster.jpg`.

4. Construct a URL for the **welcome.mp4** resource by combining the **Endpoint hostname** URL from the **cdnvideo<inject key="DeploymentID" enableCopy="false"/>** endpoint that you copied previously in the lab with a relative path of **/welcome.mp4**.

    > **Note**: For example, if your **Endpoint hostname** URL is `https://cdnvideostudent.azureedge.net/`, your newly constructed URL would be `https://cdnvideostudent.azureedge.net/welcome.mp4`.

1. On the taskbar, activate the shortcut menu for the **Microsoft Edge** icon, and then select **New window**.

1. In the new browser window, refer to the URL that you constructed for the **campus.jpg** media resource, and then verify that the resource was successfully found.

    > **Note**: If the content isn't available yet, the CDN endpoint is still initializing. This initialization process can take anywhere from 5 to 15 minutes.

1. Refer to the URL that you constructed for the **conference.jpg** media resource, and then verify that the resource was successfully found.

1. Refer to the URL that you constructed for the **poster.jpg** media resource, and then verify that the resource was successfully found.

1. Refer to the URL that you constructed for the **welcome.mp4** video resource, and then verify that the resource was successfully found.

### Task 3: Update the Web App settings

1. On the Azure portal's navigation pane, select **Resource groups**.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **landingpage<inject key="DeploymentID" enableCopy="false"/>** web app that you created previously in this lab.

1. On the **App Service** blade, in the **Settings** section, select the **Environment variables** link.

1. In the **Application settings** tab, select the existing **CDNMediaEndpoint** application setting.

1. Select the existing **CDNMediaEndpoint** application setting.

1. In the **Add/Edit application setting** pop-up dialog box, update the **Value** text box by entering the **Endpoint hostname** URL from the **cdnmedia<inject key="DeploymentID" enableCopy="false"/>** endpoint that you copied previously in the lab, and then select **Apply**.

1. Select the existing **CDNVideoEndpoint** application setting.

1. In the **Add/Edit application setting** pop-up dialog box, update the **Value** text box by entering the **Endpoint hostname** URL from the **cdnvideo<inject key="DeploymentID" enableCopy="false"/>** endpoint that you copied previously in the lab, and then select **Apply**.

1. At the bottom of the **App settings** section, select **Apply**.

   >**Note:** You may receive a warning that your app may restart when updating app settings. Select **Confirm**. Wait for your application settings to save before you continue with the lab.

1. In the **Configuration** section, select **Overview**.

1. In the **Overview** section, select **Restart**, and then select **Yes** to confirm the app restart process.

   > **Note**: Wait for the restart operation to complete before you continue with the lab. You'll receive a notification when the operation is done.

### Task 4: Test the web content

1. On the Azure portal's navigation pane, select the **Resource groups** link.

1. On the **Resource groups** blade, select the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** resource group that you created previously in this lab.

1. On the **MarketingContent-<inject key="DeploymentID" enableCopy="false"/>** blade, select the **contentdeliverynetwork** CDN profile that you created previously in this lab.

1. On the **CDN profile** blade, select the **cdnweb<inject key="DeploymentID" enableCopy="false"/>** endpoint.

1. On the **Endpoint** blade, copy the value of the **Endpoint hostname** link.

1. On the taskbar, activate the shortcut menu for the **Microsoft Edge** icon, and then select **New window**.

1. In the new browser window, refer to the **Endpoint hostname** URL for the **cdnweb<inject key="DeploymentID" enableCopy="false"/>** endpoint.

1. Observe the website and multimedia content that are all served using the Content Delivery Network.

    > **Congratulations** on completing the task! Now, it's time to validate it. Here are the steps:

    > - Hit the Validate button for the corresponding task. If you receive a success message, you can proceed to the next task. 
    > - If not, carefully read the error message and retry the step, following the instructions in the lab guide.
    > - If you need any assistance, please contact us at labs-support@spektrasystems.com. We are available 24/7 to help.

### Review

In this exercise, you updated your web app to use Content Delivery Network to serve multimedia content and to serve the web application itself.

## You have successfully completed the lab
